2025-07-07 21:37:21,994 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Kurtas'
Additional Info: {'query': 'hi, i am size medium, budget 500 looking for kurtas for female', 'gender': 'women'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 39, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 152, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 96, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Kurtas'

2025-07-08 18:19:53,278 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat endpoint error - Session: 4014fca8-9fef-4167-a91f-26c5c97a1b01: 'NoneType' object has no attribute '_add_writer'
Additional Info: {'session_id': '4014fca8-9fef-4167-a91f-26c5c97a1b01', 'user_message': 'hi'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 315, in chat_handler
    existing_user_summary = await get_user_summary_from_redis(redis_client, redis_key)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 114, in get_user_summary_from_redis
    summary_json = await redis_client.get(redis_key)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\retry.py", line 71, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 651, in _send_command_parse_response
    await conn.send_command(*args)
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 554, in send_command
    await self.send_packed_command(
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 529, in send_packed_command
    self._writer.writelines(command)
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 349, in writelines
    self._transport.writelines(data)
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\selector_events.py", line 1185, in writelines
    self._loop._add_writer(self._sock_fd, self._write_ready)
    ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute '_add_writer'

2025-07-08 18:19:53,321 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat Endpoint - chat_handler: 500: An error occurred while processing your request.
Additional Info: {'function': 'chat_handler', 'args': '()', 'kwargs': "{'redis_client': <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com,port=10533,db=0)>)>"}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 315, in chat_handler
    existing_user_summary = await get_user_summary_from_redis(redis_client, redis_key)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 114, in get_user_summary_from_redis
    summary_json = await redis_client.get(redis_key)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\retry.py", line 71, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 651, in _send_command_parse_response
    await conn.send_command(*args)
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 554, in send_command
    await self.send_packed_command(
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 529, in send_packed_command
    self._writer.writelines(command)
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 349, in writelines
    self._transport.writelines(data)
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\selector_events.py", line 1185, in writelines
    self._loop._add_writer(self._sock_fd, self._write_ready)
    ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute '_add_writer'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\logger_config.py", line 101, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 376, in chat_handler
    raise HTTPException(status_code=500, detail="An error occurred while processing your request.")
fastapi.exceptions.HTTPException: 500: An error occurred while processing your request.

2025-07-08 18:25:25,955 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat endpoint error - Session: 61ae87c2-5387-4dec-a050-7cbd34cdbc42: 500: Error calling Groq API: Error code: 400 - {'error': {'message': "'messages.1' : discriminator property 'role' has invalid value", 'type': 'invalid_request_error'}}
Additional Info: {'session_id': '61ae87c2-5387-4dec-a050-7cbd34cdbc42', 'user_message': ''}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 277, in get_detail_collection_response_with_groq
    response = await groq_client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\resources\chat\completions.py", line 649, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1818, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1526, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1627, in _request
    raise self._make_status_error_from_response(err.response) from None
groq.BadRequestError: Error code: 400 - {'error': {'message': "'messages.1' : discriminator property 'role' has invalid value", 'type': 'invalid_request_error'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 331, in chat_handler
    detail_collection_response = await get_detail_collection_response_with_groq(missing_detail, chat_history)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 293, in get_detail_collection_response_with_groq
    raise HTTPException(status_code=500, detail=f"Error calling Groq API: {e}")
fastapi.exceptions.HTTPException: 500: Error calling Groq API: Error code: 400 - {'error': {'message': "'messages.1' : discriminator property 'role' has invalid value", 'type': 'invalid_request_error'}}

2025-07-08 18:25:25,959 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat Endpoint - chat_handler: 500: An error occurred while processing your request.
Additional Info: {'function': 'chat_handler', 'args': '()', 'kwargs': "{'redis_client': <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com,port=10533,db=0)>)>"}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 277, in get_detail_collection_response_with_groq
    response = await groq_client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\resources\chat\completions.py", line 649, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1818, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1526, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1627, in _request
    raise self._make_status_error_from_response(err.response) from None
groq.BadRequestError: Error code: 400 - {'error': {'message': "'messages.1' : discriminator property 'role' has invalid value", 'type': 'invalid_request_error'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 331, in chat_handler
    detail_collection_response = await get_detail_collection_response_with_groq(missing_detail, chat_history)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 293, in get_detail_collection_response_with_groq
    raise HTTPException(status_code=500, detail=f"Error calling Groq API: {e}")
fastapi.exceptions.HTTPException: 500: Error calling Groq API: Error code: 400 - {'error': {'message': "'messages.1' : discriminator property 'role' has invalid value", 'type': 'invalid_request_error'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\logger_config.py", line 101, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 375, in chat_handler
    raise HTTPException(status_code=500, detail="An error occurred while processing your request.")
fastapi.exceptions.HTTPException: 500: An error occurred while processing your request.

2025-07-08 18:26:19,275 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat endpoint error - Session: c091e98e-a8bf-4845-bf83-32c4468e07c5: 500: Error calling Groq API: Error code: 400 - {'error': {'message': "'messages.1' : discriminator property 'role' has invalid value", 'type': 'invalid_request_error'}}
Additional Info: {'session_id': 'c091e98e-a8bf-4845-bf83-32c4468e07c5', 'user_message': ''}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 277, in get_detail_collection_response_with_groq
    response = await groq_client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\resources\chat\completions.py", line 649, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1818, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1526, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1627, in _request
    raise self._make_status_error_from_response(err.response) from None
groq.BadRequestError: Error code: 400 - {'error': {'message': "'messages.1' : discriminator property 'role' has invalid value", 'type': 'invalid_request_error'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 331, in chat_handler
    detail_collection_response = await get_detail_collection_response_with_groq(missing_detail, chat_history)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 293, in get_detail_collection_response_with_groq
    raise HTTPException(status_code=500, detail=f"Error calling Groq API: {e}")
fastapi.exceptions.HTTPException: 500: Error calling Groq API: Error code: 400 - {'error': {'message': "'messages.1' : discriminator property 'role' has invalid value", 'type': 'invalid_request_error'}}

2025-07-08 18:26:19,277 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat Endpoint - chat_handler: 500: An error occurred while processing your request.
Additional Info: {'function': 'chat_handler', 'args': '()', 'kwargs': "{'redis_client': <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com,port=10533,db=0)>)>"}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 277, in get_detail_collection_response_with_groq
    response = await groq_client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\resources\chat\completions.py", line 649, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1818, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1526, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1627, in _request
    raise self._make_status_error_from_response(err.response) from None
groq.BadRequestError: Error code: 400 - {'error': {'message': "'messages.1' : discriminator property 'role' has invalid value", 'type': 'invalid_request_error'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 331, in chat_handler
    detail_collection_response = await get_detail_collection_response_with_groq(missing_detail, chat_history)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 293, in get_detail_collection_response_with_groq
    raise HTTPException(status_code=500, detail=f"Error calling Groq API: {e}")
fastapi.exceptions.HTTPException: 500: Error calling Groq API: Error code: 400 - {'error': {'message': "'messages.1' : discriminator property 'role' has invalid value", 'type': 'invalid_request_error'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\logger_config.py", line 101, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 375, in chat_handler
    raise HTTPException(status_code=500, detail="An error occurred while processing your request.")
fastapi.exceptions.HTTPException: 500: An error occurred while processing your request.

2025-07-08 19:04:59,009 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Shirts for Women'
Additional Info: {'query': "men's medium size clothing", 'gender': 'men'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 39, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 152, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 96, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Shirts for Women'

2025-07-08 21:08:28,277 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Shirts for Women'
Additional Info: {'query': 'ethnic office wear for women', 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 39, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 152, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 96, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Shirts for Women'

2025-07-08 21:08:45,982 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Co-ords'
Additional Info: {'query': "women's party dresses formal evening wear", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 39, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 152, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 96, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Co-ords'

2025-07-08 21:09:13,877 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Shirts for Women'
Additional Info: {'query': 'feminine tops for family gathering', 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 39, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 152, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 96, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Shirts for Women'

2025-07-08 21:09:17,853 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Shirts for Women'
Additional Info: {'query': "Women's professional blazers", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 39, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 152, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 96, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Shirts for Women'

2025-07-09 11:03:44,870 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Co-ords'
Additional Info: {'query': "yellow women's coords saree outfits", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 39, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 152, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 96, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Co-ords'

2025-07-09 11:04:01,604 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Shirts for Women'
Additional Info: {'query': "yellow shirts women's", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 39, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 152, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 96, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Shirts for Women'

2025-07-09 11:53:05,661 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat endpoint error - Session: 2dcee77e-f6c6-401e-b3c8-da4f40aed306: name 'groq_intent_analysis' is not defined
Additional Info: {'session_id': '2dcee77e-f6c6-401e-b3c8-da4f40aed306', 'user_message': 'green full sleeve anarakali kurtas'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 380, in chat_handler
    "analysis": groq_intent_analysis,
                ^^^^^^^^^^^^^^^^^^^^
NameError: name 'groq_intent_analysis' is not defined

2025-07-09 11:53:05,669 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat Endpoint - chat_handler: 500: An error occurred while processing your request.
Additional Info: {'function': 'chat_handler', 'args': '()', 'kwargs': "{'redis_client': <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com,port=10533,db=0)>)>"}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 380, in chat_handler
    "analysis": groq_intent_analysis,
                ^^^^^^^^^^^^^^^^^^^^
NameError: name 'groq_intent_analysis' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\logger_config.py", line 101, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 389, in chat_handler
    raise HTTPException(status_code=500, detail="An error occurred while processing your request.")
fastapi.exceptions.HTTPException: 500: An error occurred while processing your request.

2025-07-13 08:50:55,290 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: Error code: 400 - {'error': {'message': "Failed to generate JSON. Please adjust your prompt. See 'failed_generation' for more details.", 'type': 'invalid_request_error', 'code': 'json_validate_failed', 'failed_generation': '{\n   "attributes": \n   [\n     {\n       "attribute_name": "fabric",\n       "attribute_description": "The type of material",\n       "possible_values": ["cotton", "silk", "chiffon", "georgette"],\n       "weight": 10,\n     },\n     {\n       "attribute_name": "style",\n       "attribute_description": "The design or pattern of the kurta",\n       "possible_values": ["printed", "embroidered", "plain", "anarkali"],\n       "weight": 5,\n     },\n     {\n       "attribute_name": "price",\n       "attribute_description": "The cost of the kurta",\n       "possible_values": ["less than 500"],\n       "weight": 1,\n     }\n   ]\n}'}}
Additional Info: {'query': "Women's medium size kurtas under 500 with various fabrics and styles", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 32, in search_products
    product_attributes_for_search = await self.search_engine.get_search_attributes(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 69, in get_search_attributes
    results = await asyncio.gather(*tasks)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 49, in get_attributes_for_search
    completion = await groq_client.chat.completions.create(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\resources\chat\completions.py", line 649, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1818, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1526, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1627, in _request
    raise self._make_status_error_from_response(err.response) from None
groq.BadRequestError: Error code: 400 - {'error': {'message': "Failed to generate JSON. Please adjust your prompt. See 'failed_generation' for more details.", 'type': 'invalid_request_error', 'code': 'json_validate_failed', 'failed_generation': '{\n   "attributes": \n   [\n     {\n       "attribute_name": "fabric",\n       "attribute_description": "The type of material",\n       "possible_values": ["cotton", "silk", "chiffon", "georgette"],\n       "weight": 10,\n     },\n     {\n       "attribute_name": "style",\n       "attribute_description": "The design or pattern of the kurta",\n       "possible_values": ["printed", "embroidered", "plain", "anarkali"],\n       "weight": 5,\n     },\n     {\n       "attribute_name": "price",\n       "attribute_description": "The cost of the kurta",\n       "possible_values": ["less than 500"],\n       "weight": 1,\n     }\n   ]\n}'}}

2025-07-17 11:47:00,563 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Kurtas'
Additional Info: {'query': "women's medium size kurtas under 500 rupees", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 39, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 148, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 92, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Kurtas'

2025-07-20 19:28:29,327 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Kurtas'
Additional Info: {'query': 'blue kurtas for women medium size formal wear', 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 39, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 148, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 92, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Kurtas'

2025-07-20 19:29:35,098 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Kurtas'
Additional Info: {'query': "blue women's kurtas medium online shopping", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 39, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 148, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 92, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Kurtas'

2025-07-20 20:42:51,470 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Kurtas'
Additional Info: {'query': 'feminine kurtas medium size under 500 rupees', 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 39, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 148, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 92, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Kurtas'

2025-07-20 20:46:32,091 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Kurtas'
Additional Info: {'query': 'female medium size kurtas under 500 rupees', 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 39, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 148, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 92, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Kurtas'

2025-07-22 19:29:12,359 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat POST Endpoint - store_chat_messages: 'NoneType' object has no attribute '_add_writer'
Additional Info: {'function': 'store_chat_messages', 'args': '()', 'kwargs': "{'redis_client': <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com,port=10533,db=0)>)>"}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\logger_config.py", line 101, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 334, in store_chat_messages
    await redis_client.set(messages_key, json.dumps(chat_history), ex=3600)  # 1 hour TTL
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\retry.py", line 71, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 651, in _send_command_parse_response
    await conn.send_command(*args)
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 554, in send_command
    await self.send_packed_command(
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 529, in send_packed_command
    self._writer.writelines(command)
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 349, in writelines
    self._transport.writelines(data)
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\selector_events.py", line 1185, in writelines
    self._loop._add_writer(self._sock_fd, self._write_ready)
    ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute '_add_writer'

2025-07-22 19:30:27,004 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: Error code: 400 - {'error': {'message': "Failed to generate JSON. Please adjust your prompt. See 'failed_generation' for more details.", 'type': 'invalid_request_error', 'code': 'json_validate_failed', 'failed_generation': '{\n   "attributes": \n   [\n     {\n       "attribute_name": "occasion",\n       "attribute_description": "The intended use of the kurta",\n       "possible_values": ["casual"],\n       "weight": 1\n     },\n     {\n       "attribute_name": "length of sleeves",\n       "attribute_description": "The style of the sleeves",\n       "possible_values": ["short", "long", "sleeveless"],\n       "weight": 10\n     ],\n     {\n       "attribute_name": "length",\n       "attribute_description": "The length of the kurta",\n       "possible_values": ["knee-length", "ankle-length", "midi"],\n       "weight": 2\n     }\n   ]\n}}'}}
Additional Info: {'query': "women's medium kurtas under 500 for casual wear", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 32, in search_products
    product_attributes_for_search = await self.search_engine.get_search_attributes(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 69, in get_search_attributes
    results = await asyncio.gather(*tasks)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 49, in get_attributes_for_search
    completion = await groq_client.chat.completions.create(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\resources\chat\completions.py", line 649, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1818, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1526, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1627, in _request
    raise self._make_status_error_from_response(err.response) from None
groq.BadRequestError: Error code: 400 - {'error': {'message': "Failed to generate JSON. Please adjust your prompt. See 'failed_generation' for more details.", 'type': 'invalid_request_error', 'code': 'json_validate_failed', 'failed_generation': '{\n   "attributes": \n   [\n     {\n       "attribute_name": "occasion",\n       "attribute_description": "The intended use of the kurta",\n       "possible_values": ["casual"],\n       "weight": 1\n     },\n     {\n       "attribute_name": "length of sleeves",\n       "attribute_description": "The style of the sleeves",\n       "possible_values": ["short", "long", "sleeveless"],\n       "weight": 10\n     ],\n     {\n       "attribute_name": "length",\n       "attribute_description": "The length of the kurta",\n       "possible_values": ["knee-length", "ankle-length", "midi"],\n       "weight": 2\n     }\n   ]\n}}'}}

2025-07-23 11:26:27,005 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat POST Endpoint - store_chat_messages: Error while reading from redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533 : (10054, 'An existing connection was forcibly closed by the remote host', None, 10054, None)
Additional Info: {'function': 'store_chat_messages', 'args': '()', 'kwargs': "{'redis_client': <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com,port=10533,db=0)>)>"}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 594, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\_parsers\resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\_parsers\resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\_parsers\base.py", line 283, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 545, in _wait_for_data
    await self._waiter
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\selector_events.py", line 1013, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\logger_config.py", line 101, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 334, in store_chat_messages
    await redis_client.set(messages_key, json.dumps(chat_history), ex=3600)  # 1 hour TTL
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\retry.py", line 76, in call_with_retry
    raise error
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\retry.py", line 71, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 652, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 698, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 608, in read_response
    raise ConnectionError(f"Error while reading from {host_error} : {e.args}")
redis.exceptions.ConnectionError: Error while reading from redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533 : (10054, 'An existing connection was forcibly closed by the remote host', None, 10054, None)

2025-07-23 11:32:07,146 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Kurtas'
Additional Info: {'query': "women's medium kurtas under 500 affordable options", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 41, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 148, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 92, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Kurtas'

2025-07-23 11:38:13,631 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Kurtas'
Additional Info: {'query': "Women's medium kurtas under 500 for casual wear", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 41, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 148, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 92, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Kurtas'

2025-07-23 12:15:12,197 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Kurtas'
Additional Info: {'query': "women's kurtas medium size affordable stylish outfits for casual wear", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 41, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 148, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 92, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Kurtas'

2025-07-24 12:50:25,450 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: Error code: 400 - {'error': {'message': "Failed to generate JSON. Please adjust your prompt. See 'failed_generation' for more details.", 'type': 'invalid_request_error', 'code': 'json_validate_failed', 'failed_generation': '{\n   "attributes": \n   [\n      {\n        "attribute_name": "price",\n        "attribute_description": "The cost of the kurtas",\n        "possible_values": ["less than 500"],\n        "weight": 1\n      },\n      {\n        "attribute_name": "length of sleeves",\n        "attribute_description": "The style of sleeves",\n        "possible_values": ["short", "long", "sleeveless"],\n        "weight": 10\n      ]\n   ]\n}}'}}
Additional Info: {'query': "women's medium size kurtas under 500 rupees", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 34, in search_products
    product_attributes_for_search = await self.search_engine.get_search_attributes(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 69, in get_search_attributes
    results = await asyncio.gather(*tasks)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 49, in get_attributes_for_search
    completion = await groq_client.chat.completions.create(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\resources\chat\completions.py", line 649, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1818, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1526, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1627, in _request
    raise self._make_status_error_from_response(err.response) from None
groq.BadRequestError: Error code: 400 - {'error': {'message': "Failed to generate JSON. Please adjust your prompt. See 'failed_generation' for more details.", 'type': 'invalid_request_error', 'code': 'json_validate_failed', 'failed_generation': '{\n   "attributes": \n   [\n      {\n        "attribute_name": "price",\n        "attribute_description": "The cost of the kurtas",\n        "possible_values": ["less than 500"],\n        "weight": 1\n      },\n      {\n        "attribute_name": "length of sleeves",\n        "attribute_description": "The style of sleeves",\n        "possible_values": ["short", "long", "sleeveless"],\n        "weight": 10\n      ]\n   ]\n}}'}}

2025-07-24 12:55:25,156 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat SSE endpoint error - Session: 846aef08-879f-4a30-8568-2de3573fba88: the JSON object must be str, bytes or bytearray, not coroutine
Additional Info: {'session_id': '846aef08-879f-4a30-8568-2de3573fba88', 'user_message': 'hi, i am size medium, budget 500 looking for kurtas for female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 413, in event_generator
    async for evt in chatbot_flow(groq_intent, session_id, conversation_redis_client):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\groq_utils.py", line 144, in chatbot_flow
    conversation_storage.store_search_results(
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\conversation_storage.py", line 56, in store_search_results
    retrieved_data = json.loads(stored_data)
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\json\__init__.py", line 339, in loads
    raise TypeError(f'the JSON object must be str, bytes or bytearray, '
TypeError: the JSON object must be str, bytes or bytearray, not coroutine

2025-07-24 12:59:49,299 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Kurtas'
Additional Info: {'query': 'female medium kurtas under 500 rupees', 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 41, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 148, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 92, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Kurtas'

2025-07-24 20:58:42,887 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Kurtas'
Additional Info: {'query': 'blue long sleeve embroidered kurta for women office wear medium fit', 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 43, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 148, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 92, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Kurtas'

2025-07-25 17:04:15,850 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat POST Endpoint - store_chat_messages: 'NoneType' object has no attribute '_add_writer'
Additional Info: {'function': 'store_chat_messages', 'args': '()', 'kwargs': "{'conversation_redis_client': <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com,port=1"}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\logger_config.py", line 101, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 334, in store_chat_messages
    await conversation_redis_client.set(messages_key, json.dumps(chat_history), ex=3600)  # 1 hour TTL
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\retry.py", line 71, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 651, in _send_command_parse_response
    await conn.send_command(*args)
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 554, in send_command
    await self.send_packed_command(
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 529, in send_packed_command
    self._writer.writelines(command)
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 349, in writelines
    self._transport.writelines(data)
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\selector_events.py", line 1185, in writelines
    self._loop._add_writer(self._sock_fd, self._write_ready)
    ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute '_add_writer'

2025-07-25 17:50:52,633 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: Error code: 400 - {'error': {'message': "Failed to generate JSON. Please adjust your prompt. See 'failed_generation' for more details.", 'type': 'invalid_request_error', 'code': 'json_validate_failed', 'failed_generation': '{\n   "attributes": \n   [\n     {\n       "attribute_name": "color",\n       "attribute_description": "The primary color",\n       "possible_values": ["white", "black", "pastel"],\n       "weight": 10\n     },\n     {\n       "attribute_name": "sleeveStyle",\n       "attribute_description": "The style of the sleeves",\n       "possible_values": ["long"],\n       "weight": 5\n     ]\n   ]\n}}'}}
Additional Info: {'query': "Women's office wear kurtas in white black and pastel colors with long sleeves", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 36, in search_products
    product_attributes_for_search = await self.search_engine.get_search_attributes(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 69, in get_search_attributes
    results = await asyncio.gather(*tasks)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 49, in get_attributes_for_search
    completion = await groq_client.chat.completions.create(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\resources\chat\completions.py", line 649, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1818, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1526, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1627, in _request
    raise self._make_status_error_from_response(err.response) from None
groq.BadRequestError: Error code: 400 - {'error': {'message': "Failed to generate JSON. Please adjust your prompt. See 'failed_generation' for more details.", 'type': 'invalid_request_error', 'code': 'json_validate_failed', 'failed_generation': '{\n   "attributes": \n   [\n     {\n       "attribute_name": "color",\n       "attribute_description": "The primary color",\n       "possible_values": ["white", "black", "pastel"],\n       "weight": 10\n     },\n     {\n       "attribute_name": "sleeveStyle",\n       "attribute_description": "The style of the sleeves",\n       "possible_values": ["long"],\n       "weight": 5\n     ]\n   ]\n}}'}}

2025-07-25 17:51:48,843 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Kurtas'
Additional Info: {'query': "Women's office kurtas", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 43, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 148, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 92, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Kurtas'

2025-07-25 19:07:46,544 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: Error code: 400 - {'error': {'message': "Failed to generate JSON. Please adjust your prompt. See 'failed_generation' for more details.", 'type': 'invalid_request_error', 'code': 'json_validate_failed', 'failed_generation': '{\n   "attributes": \n   [\n     {\n       "attribute_name": "color",\n       "attribute_description": "The primary color",\n       "possible_values": ["red", "blue", "green", "yellow", "black"],\n       "weight": 10\n     },\n     {\n       "attribute_name": "fabric",\n       "attribute_description": "The type of fabric used",\n       "possible_values": ["cotton", "silk", "rayon", "linen", "chiffon"],\n       "weight": 5\n     },\n     {\n       "attribute_name": "fit",\n       "attribute_description": "The style or cut of the kurta",\n       "possible_values": ["loose", "relaxed", "comfort"],\n       "weight": 2\n     ]\n   ]\n}}'}}
Additional Info: {'query': "women's casual loose kurtas in various colors and fabrics online", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 36, in search_products
    product_attributes_for_search = await self.search_engine.get_search_attributes(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 55, in get_search_attributes
    results = await asyncio.gather(*tasks)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 35, in get_attributes_for_search
    completion = await groq_client.chat.completions.create(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\resources\chat\completions.py", line 649, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1818, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1526, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1627, in _request
    raise self._make_status_error_from_response(err.response) from None
groq.BadRequestError: Error code: 400 - {'error': {'message': "Failed to generate JSON. Please adjust your prompt. See 'failed_generation' for more details.", 'type': 'invalid_request_error', 'code': 'json_validate_failed', 'failed_generation': '{\n   "attributes": \n   [\n     {\n       "attribute_name": "color",\n       "attribute_description": "The primary color",\n       "possible_values": ["red", "blue", "green", "yellow", "black"],\n       "weight": 10\n     },\n     {\n       "attribute_name": "fabric",\n       "attribute_description": "The type of fabric used",\n       "possible_values": ["cotton", "silk", "rayon", "linen", "chiffon"],\n       "weight": 5\n     },\n     {\n       "attribute_name": "fit",\n       "attribute_description": "The style or cut of the kurta",\n       "possible_values": ["loose", "relaxed", "comfort"],\n       "weight": 2\n     ]\n   ]\n}}'}}

2025-07-25 19:08:29,880 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: Error code: 400 - {'error': {'message': "Failed to generate JSON. Please adjust your prompt. See 'failed_generation' for more details.", 'type': 'invalid_request_error', 'code': 'json_validate_failed', 'failed_generation': '{\n   "attributes": \n   [\n     {\n       "attribute_name": "color",\n       "attribute_description": "The primary color",\n       "possible_values": ["white", "blue", "yellow"],\n       "weight": 10\n     },\n     {\n       "attribute_name": "occasion",\n       "attribute_description": "The intended use or occasion",\n       "possible_values": ["office wear"],\n       "weight": 5\n     ]\n   ]\n}}'}}
Additional Info: {'query': "women's medium white blue or yellow kurtas for office wear", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 36, in search_products
    product_attributes_for_search = await self.search_engine.get_search_attributes(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 55, in get_search_attributes
    results = await asyncio.gather(*tasks)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 35, in get_attributes_for_search
    completion = await groq_client.chat.completions.create(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\resources\chat\completions.py", line 649, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1818, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1526, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\groq\_base_client.py", line 1627, in _request
    raise self._make_status_error_from_response(err.response) from None
groq.BadRequestError: Error code: 400 - {'error': {'message': "Failed to generate JSON. Please adjust your prompt. See 'failed_generation' for more details.", 'type': 'invalid_request_error', 'code': 'json_validate_failed', 'failed_generation': '{\n   "attributes": \n   [\n     {\n       "attribute_name": "color",\n       "attribute_description": "The primary color",\n       "possible_values": ["white", "blue", "yellow"],\n       "weight": 10\n     },\n     {\n       "attribute_name": "occasion",\n       "attribute_description": "The intended use or occasion",\n       "possible_values": ["office wear"],\n       "weight": 5\n     ]\n   ]\n}}'}}

2025-07-27 10:07:24,359 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Master search function error: 'Kurtas'
Additional Info: {'query': "white women's medium office kurtas", 'gender': 'female'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\master_search.py", line 43, in search_products
    attribute_results_by_product_type = await self.search_engine.run_attribute_search_for_all_product_types(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 149, in run_attribute_search_for_all_product_types
    rerank_results = await asyncio.gather(*rerank_tasks)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\search_engine.py", line 93, in rerank_all_for_product_type
    documents = [v["group_description"] for v in self.data.group_descriptions[product_type].values()]
                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'Kurtas'

2025-07-27 16:39:27,632 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat POST Endpoint - store_chat_messages: Error while reading from redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533 : (10054, 'An existing connection was forcibly closed by the remote host', None, 10054, None)
Additional Info: {'function': 'store_chat_messages', 'args': '()', 'kwargs': "{'conversation_redis_client': <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com,port=1"}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 594, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\_parsers\resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\_parsers\resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\_parsers\base.py", line 283, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 545, in _wait_for_data
    await self._waiter
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\selector_events.py", line 1013, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\logger_config.py", line 101, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 334, in store_chat_messages
    await conversation_redis_client.set(messages_key, json.dumps(chat_history), ex=3600)  # 1 hour TTL
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\retry.py", line 76, in call_with_retry
    raise error
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\retry.py", line 71, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 652, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 698, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 608, in read_response
    raise ConnectionError(f"Error while reading from {host_error} : {e.args}")
redis.exceptions.ConnectionError: Error while reading from redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533 : (10054, 'An existing connection was forcibly closed by the remote host', None, 10054, None)

2025-07-31 15:22:27,219 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat SSE endpoint error - Session: 1e82d2fa-481b-4a5c-90ae-bf86822ef8c1: Syntax error at offset 149 near >[
Additional Info: {'session_id': '1e82d2fa-481b-4a5c-90ae-bf86822ef8c1', 'user_message': 'hi, i am size medium, budget5000 looking for white kurta for female for office'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 461, in event_generator
    async for evt in chatbot_flow(groq_intent, session_id, conversation_redis_client, updated_summary):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\groq_utils.py", line 245, in chatbot_flow
    res = await search_and_pitch(
          ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\rag_search_flow.py", line 349, in search_and_pitch
    search_results = await search_products_with_query(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\rag_search_flow.py", line 183, in search_products_with_query
    search_results = vector_embeddings_redis_client.ft('idx:product_text_description_embedding').search(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\commands\search\commands.py", line 519, in search
    res = self.execute_command(SEARCH_CMD, *args, **options)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\client.py", line 623, in execute_command
    return self._execute_command(*args, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\client.py", line 634, in _execute_command
    return conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\retry.py", line 87, in call_with_retry
    return do()
           ^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\client.py", line 635, in <lambda>
    lambda: self._send_command_parse_response(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\client.py", line 606, in _send_command_parse_response
    return self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\client.py", line 650, in parse_response
    response = connection.read_response(disable_decoding=True)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\connection.py", line 666, in read_response
    raise response
redis.exceptions.ResponseError: Syntax error at offset 149 near >[

2025-07-31 21:14:49,817 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat POST Endpoint - store_chat_messages: Error 11001 connecting to redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533. getaddrinfo failed.
Additional Info: {'function': 'store_chat_messages', 'args': '()', 'kwargs': "{'conversation_redis_client': <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com,port=1"}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 302, in connect_check_health
    await self.retry.call_with_retry(
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\retry.py", line 71, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 755, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1078, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1454, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 899, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno 11001] getaddrinfo failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\logger_config.py", line 101, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 379, in store_chat_messages
    await conversation_redis_client.set(messages_key, json.dumps(chat_history), ex=3600)  # 1 hour TTL
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 1141, in get_connection
    await self.ensure_connection(connection)
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 1174, in ensure_connection
    await connection.connect()
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 310, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 11001 connecting to redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533. getaddrinfo failed.

2025-08-01 12:04:56,556 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat POST Endpoint - store_chat_messages: 'NoneType' object has no attribute '_add_writer'
Additional Info: {'function': 'store_chat_messages', 'args': '()', 'kwargs': "{'conversation_redis_client': <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com,port=1"}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\logger_config.py", line 101, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 379, in store_chat_messages
    await conversation_redis_client.set(messages_key, json.dumps(chat_history), ex=3600)  # 1 hour TTL
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 677, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\retry.py", line 71, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 651, in _send_command_parse_response
    await conn.send_command(*args)
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 554, in send_command
    await self.send_packed_command(
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 529, in send_packed_command
    self._writer.writelines(command)
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 349, in writelines
    self._transport.writelines(data)
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\selector_events.py", line 1185, in writelines
    self._loop._add_writer(self._sock_fd, self._write_ready)
    ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute '_add_writer'

2025-08-18 23:01:44,324 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat POST Endpoint - store_chat_messages: Error 11001 connecting to redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533. getaddrinfo failed.
Additional Info: {'function': 'store_chat_messages', 'args': '()', 'kwargs': "{'conversation_redis_client': <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com,port=1"}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 302, in connect_check_health
    await self.retry.call_with_retry(
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\retry.py", line 71, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 755, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1078, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1454, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 899, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno 11001] getaddrinfo failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\logger_config.py", line 101, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 575, in store_chat_messages
    await conversation_redis_client.set(messages_key, json.dumps(chat_history), ex=3600)  # 1 hour TTL
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 1141, in get_connection
    await self.ensure_connection(connection)
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 1174, in ensure_connection
    await connection.connect()
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 310, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 11001 connecting to redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533. getaddrinfo failed.

2025-08-19 11:23:52,552 - chatbot - ERROR - main.py:986 - unified_chat_handler - Error in unified chat handler: Error 11001 connecting to redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533. getaddrinfo failed.
2025-08-19 11:23:52,867 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat SSE endpoint error - Session: 1d931241-7cc8-4bd1-9fbd-f44e3e936c33: Error 11001 connecting to redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533. getaddrinfo failed.
Additional Info: {'session_id': '1d931241-7cc8-4bd1-9fbd-f44e3e936c33'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 302, in connect_check_health
    await self.retry.call_with_retry(
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\retry.py", line 71, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 755, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1078, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1454, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 899, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno 11001] getaddrinfo failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 669, in event_generator
    async for result in process_chat_logic(session_id, conversation_redis_client):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 593, in process_chat_logic
    stored_history = await conversation_redis_client.get(messages_key)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 1141, in get_connection
    await self.ensure_connection(connection)
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 1174, in ensure_connection
    await connection.connect()
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 310, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 11001 connecting to redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533. getaddrinfo failed.

2025-08-19 11:25:00,825 - chatbot - ERROR - main.py:986 - unified_chat_handler - Error in unified chat handler: Error 11001 connecting to redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533. getaddrinfo failed.
2025-08-19 11:25:00,852 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat SSE endpoint error - Session: 35e0c8c2-aa76-4515-b652-c35cc079d7c8: Error 11001 connecting to redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533. getaddrinfo failed.
Additional Info: {'session_id': '35e0c8c2-aa76-4515-b652-c35cc079d7c8'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 302, in connect_check_health
    await self.retry.call_with_retry(
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\retry.py", line 71, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 755, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1078, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1454, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 899, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno 11001] getaddrinfo failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 669, in event_generator
    async for result in process_chat_logic(session_id, conversation_redis_client):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 593, in process_chat_logic
    stored_history = await conversation_redis_client.get(messages_key)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 1141, in get_connection
    await self.ensure_connection(connection)
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 1174, in ensure_connection
    await connection.connect()
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 310, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 11001 connecting to redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533. getaddrinfo failed.

2025-08-19 11:47:39,111 - chatbot - ERROR - main.py:964 - unified_chat_handler - Error in unified chat handler: Error 11001 connecting to redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533. getaddrinfo failed.
2025-08-19 11:48:48,494 - chatbot - ERROR - main.py:964 - unified_chat_handler - Error in unified chat handler: Error 11001 connecting to redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533. getaddrinfo failed.
2025-08-19 11:48:48,565 - chatbot - ERROR - logger_config.py:72 - log_error - ERROR in Chat SSE endpoint error - Session: 35e0c8c2-aa76-4515-b652-c35cc079d7c8: Error 11001 connecting to redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533. getaddrinfo failed.
Additional Info: {'session_id': '35e0c8c2-aa76-4515-b652-c35cc079d7c8'}
Traceback:
Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 302, in connect_check_health
    await self.retry.call_with_retry(
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\retry.py", line 71, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 755, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1078, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1454, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 899, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno 11001] getaddrinfo failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 648, in event_generator
    async for result in process_chat_logic(session_id):
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\chatbot_fastapi\main.py", line 575, in process_chat_logic
    stored_history = await redis_client.get(messages_key)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 1141, in get_connection
    await self.ensure_connection(connection)
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 1174, in ensure_connection
    await connection.connect()
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
  File "C:\Users\mathe\OneDrive\Documents\EcommChatbotShopify\shopify_venv\Lib\site-packages\redis\asyncio\connection.py", line 310, in connect_check_health
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 11001 connecting to redis-10533.c9.us-east-1-2.ec2.redns.redis-cloud.com:10533. getaddrinfo failed.

